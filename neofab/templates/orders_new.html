{# templates/orders_new.html #}
{% extends "base.html" %}

{% block content %}
<h1>Create new order</h1>

<form method="post">
    <div class="mb-3">
        <label for="title" class="form-label">Title *</label>
        <input type="text"
               class="form-control"
               id="title"
               name="title"
               required>
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control"
                  id="description"
                  name="description"
                  rows="4"></textarea>
    </div>

    {# Status: only admin can choose, user sees fixed "New" #}
    {% if current_user.role == 'admin' %}
        <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" name="status">
                {% for value, label in order_statuses %}
                    <option value="{{ value }}">{{ label }}</option>
                {% endfor %}
            </select>
        </div>
    {% else %}
        <div class="mb-3">
            <label class="form-label">Initial status</label><br>
            <span class="badge bg-secondary">New</span>
            <!-- hidden field is optional, Backend ignoriert es sowieso für User -->
            <input type="hidden" name="status" value="new">
        </div>
    {% endif %}

    <!-- NEU: Material-Auswahl -->
    <div class="mb-3">
        <label for="material_id" class="form-label">Material</label>
        <select class="form-select" id="material_id" name="material_id">
            <option value="">– Please select –</option>
            {% for m in materials %}
                <option value="{{ m.id }}">{{ m.name }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- NEU: Farb-Auswahl -->
    <div class="mb-3">
        <label for="color_id" class="form-label">Color</label>
        <select class="form-select" id="color_id" name="color_id">
            <option value="">– Please select –</option>
            {% for c in colors %}
                <option value="{{ c.id }}">
                    {{ c.name }}
                    {% if c.hex_code %} ({{ c.hex_code }}){% endif %}
                </option>
            {% endfor %}
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Create order</button>
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
</form>
{% endblock %}
