{% extends "base.html" %}

{% block title %}
    {{ color and t("admin_color_form_title_edit") or t("admin_color_form_title_new") }} - NeoFab
{% endblock %}

{% block content %}
<h1 class="mb-4">
    {{ color and t("admin_color_form_title_edit") or t("admin_color_form_title_new") }}
</h1>

<div class="card">
    <div class="card-body">
        <form method="post">
            <!-- NAME -->
            <div class="mb-3">
                <label for="name" class="form-label">{{ t("admin_color_label_name") }}</label>
                <input type="text"
                       class="form-control"
                       id="name"
                       name="name"
                       required
                       value="{{ color.name if color else '' }}">
                <div class="form-text">e.g. Black, White, Red, Blue â€¦</div>
            </div>

            <!-- HEX CODE + COLOR PICKER -->
            <div class="mb-3">
                <label for="hex_code" class="form-label">{{ t("admin_color_label_hex") }}</label>

                <div class="input-group">
                    <span class="input-group-text p-0">
                        <input type="color"
                               class="form-control form-control-color border-0"
                               id="color_picker"
                               aria-label="Color picker"
                               value="{{ color.hex_code if color else '#ffffff' }}"
                               oninput="syncFromPicker()"
                               style="width: 42px; height: 38px; padding: 4px;">
                    </span>

                    <input type="text"
                           class="form-control"
                           id="hex_code"
                           name="hex_code"
                           placeholder="#RRGGBB"
                           value="{{ color.hex_code if color else '' }}"
                           oninput="syncFromHex()">
                </div>

                <div class="form-text">
                    {{ t("admin_color_hint_examples") }}
                </div>
            </div>

            <!-- BUTTONS -->
            <button type="submit" class="btn btn-primary">{{ t("btn_save") }}</button>
            <a href="{{ url_for('admin_color_list') }}" class="btn btn-secondary">{{ t("btn_cancel") }}</a>
        </form>
    </div>
</div>

<!-- LIVE-FARBVORSCHAU SCRIPT -->
<script>
function isHexColor(value) {
    return /^#([0-9A-Fa-f]{6})$/.test(value);
}

function syncFromHex() {
    const hexInput = document.getElementById("hex_code");
    const picker = document.getElementById("color_picker");
    const value = hexInput.value.trim();

    if (isHexColor(value)) {
        picker.value = value;
    }
}

function syncFromPicker() {
    const hexInput = document.getElementById("hex_code");
    const picker = document.getElementById("color_picker");

    const value = picker.value;
    hexInput.value = value;
}
</script>

{% endblock %}
