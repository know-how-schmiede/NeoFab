{# templates/dashboard.html #}
{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Dashboard</h1>

    <!-- Button: Neuer Auftrag -->
    <a href="{{ url_for('new_order') }}" class="btn btn-primary">
        Neuer Auftrag
    </a>
</div>

<hr>

<h2 class="mt-4">
    {% if current_user.role == 'admin' %}
        Neue Auftr채ge
    {% else %}
        Meine Auftr채ge
    {% endif %}
</h2>

{% if orders %}
    <table class="table table-striped mt-3">
        <thead>
            <tr>
                <th>#</th>
                <th>Titel</th>
                <th>Status</th>
                <th>Erstellt am</th>
                {% if current_user.role == 'admin' %}
                    <th>Auftraggeber</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for o in orders %}
            <tr>
                <td>{{ o.id }}</td>
                <td>{{ o.title }}</td>
                <td>{{ o.status }}</td>
                <td>
                    {% if o.created_at %}
                        {{ o.created_at.strftime('%d.%m.%Y %H:%M') }}
                    {% endif %}
                </td>
                {% if current_user.role == 'admin' %}
                    <td>
                        {% if o.user %}
                            {{ o.user.first_name or '' }} {{ o.user.last_name or '' }}<br>
                            <small class="text-muted">{{ o.user.email }}</small>
                        {% endif %}
                    </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p class="mt-3 text-muted">
        {% if current_user.role == 'admin' %}
            Es liegen aktuell keine neuen Auftr채ge vor.
        {% else %}
            Du hast noch keine Auftr채ge erstellt.
        {% endif %}
    </p>
{% endif %}

{% endblock %}